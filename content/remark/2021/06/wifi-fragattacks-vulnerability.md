+++
title = "遅まきながら FragAttacks 脆弱性に関する覚え書き"
date =  "2021-06-20T10:45:22+09:00"
description = "ひと月以上前の話で恐縮だが，ほぼ全ての Wi-Fi 製品が該当するとされる通称 “FragAttacks” 脆弱性について遅まきながらまとめておく。"
image = "/images/attention/kitten.jpg"
tags = [ "security", "vulnerability", "wireless" ]
pageType = "text"

[scripts]
  mathjax = false
  mermaidjs = false
+++

ひと月以上前の話で恐縮だが，ほぼ全ての Wi-Fi 製品が該当するとされる通称 “[FragAttacks]” 脆弱性について遅まきながらまとめておく。

{{< fig-quote type="markdown" title="FragAttacks: Security flaws in all Wi-Fi devices" link="https://www.fragattacks.com/" lang="en" >}}
{{% quote %}}The discovered vulnerabilities affect all modern security protocols of Wi-Fi, including the latest WPA3 specification. Even the original security protocol of Wi-Fi, called WEP, is affected. This means that several of the newly discovered design flaws have been part of Wi-Fi since its release in 1997!{{% /quote %}}
{{< /fig-quote >}}

[FragAttacks] 脆弱性は複数ある。

*設計上の欠陥（design flaws）とされるもの：*

- [CVE-2020-24588](https://nvd.nist.gov/vuln/detail/CVE-2020-24588): aggregation attack (accepting non-SPP A-MSDU frames).
- [CVE-2020-24587](https://nvd.nist.gov/vuln/detail/CVE-2020-24587): mixed key attack (reassembling fragments encrypted under different keys).
- [CVE-2020-24586](https://nvd.nist.gov/vuln/detail/CVE-2020-24586): fragment cache attack (not clearing fragments from memory when (re)connecting to a network).

*実装上の脆弱性（implementation vulnerabilities）とされるもの：*

- [CVE-2020-26145](https://nvd.nist.gov/vuln/detail/CVE-2020-26145): Accepting plaintext broadcast fragments as full frames (in an encrypted network).
- [CVE-2020-26144](https://nvd.nist.gov/vuln/detail/CVE-2020-26144): Accepting plaintext A-MSDU frames that start with an RFC1042 header with EtherType EAPOL (in an encrypted network).
- [CVE-2020-26140](https://nvd.nist.gov/vuln/detail/CVE-2020-26140): Accepting plaintext data frames in a protected network.
- [CVE-2020-26143](https://nvd.nist.gov/vuln/detail/CVE-2020-26143): Accepting fragmented plaintext data frames in a protected network.
- [CVE-2020-26139](https://nvd.nist.gov/vuln/detail/CVE-2020-26139): Forwarding EAPOL frames even though the sender is not yet authenticated (should only affect APs).
- [CVE-2020-26146](https://nvd.nist.gov/vuln/detail/CVE-2020-26146): Reassembling encrypted fragments with non-consecutive packet numbers.
- [CVE-2020-26147](https://nvd.nist.gov/vuln/detail/CVE-2020-26147): Reassembling mixed encrypted/plaintext fragments.
- [CVE-2020-26142](https://nvd.nist.gov/vuln/detail/CVE-2020-26142): Processing fragmented frames as full frames.
- [CVE-2020-26141](https://nvd.nist.gov/vuln/detail/CVE-2020-26141): Not verifying the TKIP MIC of fragmented frames.

このうち設計上の欠陥とされるものは

{{< fig-quote type="markdown" title="FragAttacks: Security flaws in all Wi-Fi devices" link="https://www.fragattacks.com/" lang="en" >}}
{{% quote %}}Fortunately, the design flaws are hard to abuse because doing so requires user interaction or is only possible when using uncommon network settings.{{% /quote %}}
{{< /fig-quote >}}

ということなので，鼻の先は大丈夫だろう。
実装上の脆弱性については，スマホやパソコン等では既に対策パッチが出回っているだろうが，無線 LAN ルータ等については[ベンダ情報](https://jvn.jp/vu/JVNVU93485736/ "JVNVU#93485736: IEEE802.11 規格のフレームアグリゲーションやフラグメンテーションに関する複数の問題（FragAttack）")に注意する必要がある。

## その他のブックマーク

- [vanhoefm/fragattacks](https://github.com/vanhoefm/fragattacks)
- [JVNVU#93485736: IEEE802.11 規格のフレームアグリゲーションやフラグメンテーションに関する複数の問題（FragAttack）](https://jvn.jp/vu/JVNVU93485736/)
- [事実上ほぼ全てのWi-Fiデバイスに内在する脆弱性「FragAttacks」が公開される、ユーザー名やパスワードの流出、PCの乗っ取りも可能 - GIGAZINE](https://gigazine.net/news/20210512-fragattacks-security-flaws-all-wi-fi-devices/)
- [すべてのWi-Fi製品に影響及ぼす可能性ある脆弱性、再び発見 | TECH+](https://news.mynavi.jp/article/20210513-1887755/)
- [【利便性を向上するWi-Fi規格】特別編（1）全Wi-Fi機器に影響する脆弱性「FragAttack」の仕組みとは？【ネット新技術】 - INTERNET Watch](https://internet.watch.impress.co.jp/docs/column/nettech/1325925.html)
  - [【利便性を向上するWi-Fi規格】特別編（2）全Wi-Fi機器に影響、脆弱性「FragAttack」悪用した攻撃手法とは？【ネット新技術】 - INTERNET Watch](https://internet.watch.impress.co.jp/docs/column/nettech/1328278.html)
  - [【利便性を向上するWi-Fi規格】特別編（3）脆弱性「FragAttack」を悪用する3つ目の攻撃シナリオとその手法【ネット新技術】 - INTERNET Watch](https://internet.watch.impress.co.jp/docs/column/nettech/1329160.html)

[FragAttacks]: https://www.fragattacks.com/ "FragAttacks: Security flaws in all Wi-Fi devices"
