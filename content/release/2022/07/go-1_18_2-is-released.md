+++
title = "Go 1.18.4 のリリース【セキュリティ・アップデート】"
date =  "2022-07-17T12:05:57+09:00"
description = "Go 1.18.2 から 1.18.4 までのセキュリティ・アップデートをまとめて紹介する。"
image = "/images/attention/go-logo_blue.png"
tags  = [ "programming", "language", "golang", "ubuntu", "security", "vulnerability" ]
pageType = "text"

[scripts]
  mathjax = false
  mermaidjs = false
+++

5月のGW以降，妙に忙しくて諸々の更新をサボっていたら [Go] のセキュリティ・アップデートはバンバン出るし 1.19 のリリース候補版も登場してるしでアワアワしている。

この記事では [1.18.1]({{< ref "/release/2022/04/go-1_18_1-is-released.md" >}} "Go 1.18.1 のリリース【セキュリティ・アップデート】") 以降のセキュリティ・アップデートをまとめて紹介する。

- [[security] Go 1.18.2 and Go 1.17.10 are released](https://groups.google.com/g/golang-announce/c/Y5qrqw_lWdU)
- [[security] Go 1.18.3 and Go 1.17.11 are released](https://groups.google.com/g/golang-announce/c/TzIC9-t8Ytg)
- [[security] Go 1.18.4 and Go 1.17.12 are released](https://groups.google.com/g/golang-announce/c/nqrv9fbR0zE)

## [CVE-2022-29526] syscall: fix Faccessat on Linux

{{< fig-quote type="markdown" title="Go 1.18.2 and Go 1.17.10 are released" link="https://groups.google.com/g/golang-announce/c/Y5qrqw_lWdU" lang="en" >}}
{{% quote %}}When called with a non-zero flags parameter, the Faccessat function could incorrectly report that a file is accessible{{% /quote %}}.
{{< /fig-quote >}}

- `CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N`
- 深刻度: 警告 (Score: 5.3)

| 基本評価基準 | 評価値 |
|--------|-------|
| 攻撃元区分 | ネットワーク |
| 攻撃条件の複雑さ | 低 |
| 必要な特権レベル | 不要 |
| ユーザ関与レベル | 不要 |
| スコープ | 変更なし |
| 機密性への影響 | 低 |
| 完全性への影響 | なし |
| 可用性への影響 | なし |

## [CVE-2022-30634] crypto/rand: rand.Read hangs with extremely large buffers

{{< fig-quote type="markdown" title="Go 1.18.3 and Go 1.17.11 are released" link="https://groups.google.com/g/golang-announce/c/TzIC9-t8Ytg" lang="en" >}}
{{% quote %}}On Windows, rand.Read will hang indefinitely if passed a buffer larger than `1 << 32 - 1` bytes{{% /quote %}}.
{{< /fig-quote >}}

- `CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H`
- 深刻度: 重要 (Score: 7.5)

| 基本評価基準 | 評価値 |
|--------|-------|
| 攻撃元区分 | ネットワーク |
| 攻撃条件の複雑さ | 低 |
| 必要な特権レベル | 不要 |
| ユーザ関与レベル | 不要 |
| スコープ | 変更なし |
| 機密性への影響 | なし |
| 完全性への影響 | なし |
| 可用性への影響 | 高 |

## [CVE-2022-30629] crypto/tls: session tickets lack random ticket_age_add

{{< fig-quote type="markdown" title="Go 1.18.3 and Go 1.17.11 are released" link="https://groups.google.com/g/golang-announce/c/TzIC9-t8Ytg" lang="en" >}}
{{% quote %}}Session tickets generated by `crypto/tls` did not contain a randomly generated `ticket_age_add`. This allows an attacker that can observe TLS handshakes to correlate successive connections by comparing ticket ages during session resumption{{% /quote %}}.
{{< /fig-quote >}}

- `CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:L/I:N/A:N`
- 深刻度: 注意 (Score: 3.1)

| 基本評価基準 | 評価値 |
|--------|-------|
| 攻撃元区分 | ネットワーク |
| 攻撃条件の複雑さ | 高 |
| 必要な特権レベル | 不要 |
| ユーザ関与レベル | 要 |
| スコープ | 変更なし |
| 機密性への影響 | 低 |
| 完全性への影響 | なし |
| 可用性への影響 | なし |

## [CVE-2022-30580] os/exec: empty Cmd.Path can result in running unintended binary on Windows

{{< fig-quote type="markdown" title="Go 1.18.3 and Go 1.17.11 are released" link="https://groups.google.com/g/golang-announce/c/TzIC9-t8Ytg" lang="en" >}}
{{% quote %}}If, on Windows, `Cmd.Run`, `cmd.Start`, `cmd.Output`, or `cmd.CombinedOutput` are executed when `Cmd.Path` is unset and, in the working directory, there are binaries named either "`..com`" or "`..exe`", they will be executed{{% /quote %}}.
{{< /fig-quote >}}

- `CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H`
- 深刻度: 重要 (Score: 7.8)

| 基本評価基準 | 評価値 |
|--------|-------|
| 攻撃元区分 | ローカル |
| 攻撃条件の複雑さ | 低 |
| 必要な特権レベル | 低 |
| ユーザ関与レベル | 不要 |
| スコープ | 変更なし |
| 機密性への影響 | 高 |
| 完全性への影響 | 高 |
| 可用性への影響 | 高 |

## [CVE-2022-29804] path/filepath: Clean(`.\c:`) returns `c:` on Windows

{{< fig-quote title="Go 1.18.3 and Go 1.17.11 are released" link="https://groups.google.com/g/golang-announce/c/TzIC9-t8Ytg" lang="en" >}}
{{% quote %}}On Windows, the <code>filepath.Clean</code> function could convert an invalid path to a valid, absolute path. For example, <code>Clean(&#96;.\c:&#96;)</code> returned <code>&#96;c:&#96;</code>{{% /quote %}}.
{{< /fig-quote >}}

- `CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N`
- 深刻度: 重要 (Score: 7.5)

| 基本評価基準 | 評価値 |
|--------|-------|
| 攻撃元区分 | ネットワーク |
| 攻撃条件の複雑さ | 低 |
| 必要な特権レベル | 不要 |
| ユーザ関与レベル | 不要 |
| スコープ | 変更なし |
| 機密性への影響 | 高 |
| 完全性への影響 | なし |
| 可用性への影響 | なし |

## [CVE-2022-1705] net/http: improper sanitization of Transfer-Encoding header

{{< fig-quote type="markdown" title="Go 1.18.4 and Go 1.17.12 are released" link="https://groups.google.com/g/golang-announce/c/nqrv9fbR0zE" lang="en" >}}
{{% quote %}}The HTTP/1 client accepted some invalid Transfer-Encoding headers as indicating a "chunked" encoding. This could potentially allow for request smuggling, but only if combined with an intermediate server that also improperly failed to reject the header as invalid{{% /quote %}}.
{{< /fig-quote >}}

- `CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:N`
- 深刻度: 警告 (Score: 6.5)

| 基本評価基準 | 評価値 |
|--------|-------|
| 攻撃元区分 | ネットワーク |
| 攻撃条件の複雑さ | 低 |
| 必要な特権レベル | 不要 |
| ユーザ関与レベル | 不要 |
| スコープ | 変更なし |
| 機密性への影響 | 低 |
| 完全性への影響 | 低 |
| 可用性への影響 | なし |

## [CVE-2022-32148]

{{< fig-quote type="markdown" title="Go 1.18.4 and Go 1.17.12 are released" link="https://groups.google.com/g/golang-announce/c/nqrv9fbR0zE" lang="en" >}}
{{% quote %}}When `httputil.ReverseProxy.ServeHTTP` was called with a `Request.Header` map containing a nil value for the `X-Forwarded-For` header, `ReverseProxy` would set the client IP as the value of the `X-Forwarded-For` header, contrary to its documentation. In the more usual case where a Director function set the `X-Forwarded-For` header value to nil, `ReverseProxy` would leave the header unmodified as expected{{% /quote %}}.
{{< /fig-quote >}}

- `CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:N`
- 深刻度: 警告 (Score: 6.5)

| 基本評価基準 | 評価値 |
|--------|-------|
| 攻撃元区分 | ネットワーク |
| 攻撃条件の複雑さ | 低 |
| 必要な特権レベル | 不要 |
| ユーザ関与レベル | 不要 |
| スコープ | 変更なし |
| 機密性への影響 | 低 |
| 完全性への影響 | 低 |
| 可用性への影響 | なし |

## [CVE-2022-30631] compress/gzip: stack exhaustion in Reader.Read

{{< fig-quote type="markdown" title="Go 1.18.4 and Go 1.17.12 are released" link="https://groups.google.com/g/golang-announce/c/nqrv9fbR0zE" lang="en" >}}
{{% quote %}}Calling `Reader.Read` on an archive containing a large number of concatenated 0-length compressed files can cause a panic due to stack exhaustion{{% /quote %}}.
{{< /fig-quote >}}

- `CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H`
- 深刻度: 重要 (Score: 7.5)

| 基本評価基準 | 評価値 |
|--------|-------|
| 攻撃元区分 | ネットワーク |
| 攻撃条件の複雑さ | 低 |
| 必要な特権レベル | 不要 |
| ユーザ関与レベル | 不要 |
| スコープ | 変更なし |
| 機密性への影響 | なし |
| 完全性への影響 | なし |
| 可用性への影響 | 高 |

## [CVE-2022-30633] encoding/xml: stack exhaustion in Unmarshal

{{< fig-quote type="markdown" title="Go 1.18.4 and Go 1.17.12 are released" link="https://groups.google.com/g/golang-announce/c/nqrv9fbR0zE" lang="en" >}}
{{% quote %}}Calling `Unmarshal` on a XML document into a Go struct which has a nested field that uses the any field tag can cause a panic due to stack exhaustion{{% /quote %}}.
{{< /fig-quote >}}

- `CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H`
- 深刻度: 重要 (Score: 7.5)

| 基本評価基準 | 評価値 |
|--------|-------|
| 攻撃元区分 | ネットワーク |
| 攻撃条件の複雑さ | 低 |
| 必要な特権レベル | 不要 |
| ユーザ関与レベル | 不要 |
| スコープ | 変更なし |
| 機密性への影響 | なし |
| 完全性への影響 | なし |
| 可用性への影響 | 高 |

## [CVE-2022-28131] encoding/xml: stack exhaustion in Decoder.Skip

{{< fig-quote type="markdown" title="Go 1.18.4 and Go 1.17.12 are released" link="https://groups.google.com/g/golang-announce/c/nqrv9fbR0zE" lang="en" >}}
{{% quote %}}Calling `Decoder.Skip` when parsing a deeply nested XML document can cause a panic due to stack exhaustion{{% /quote %}}.
{{< /fig-quote >}}

- `CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H`
- 深刻度: 重要 (Score: 7.5)

| 基本評価基準 | 評価値 |
|--------|-------|
| 攻撃元区分 | ネットワーク |
| 攻撃条件の複雑さ | 低 |
| 必要な特権レベル | 不要 |
| ユーザ関与レベル | 不要 |
| スコープ | 変更なし |
| 機密性への影響 | なし |
| 完全性への影響 | なし |
| 可用性への影響 | 高 |

## [CVE-2022-30635] encoding/gob: stack exhaustion in Decoder.Decode

{{< fig-quote type="markdown" title="Go 1.18.4 and Go 1.17.12 are released" link="https://groups.google.com/g/golang-announce/c/nqrv9fbR0zE" lang="en" >}}
{{% quote %}}Calling `Decoder.Decode` on a message which contains deeply nested structures can cause a panic due to stack exhaustion{{% /quote %}}.
{{< /fig-quote >}}

- `CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H`
- 深刻度: 重要 (Score: 7.5)

| 基本評価基準 | 評価値 |
|--------|-------|
| 攻撃元区分 | ネットワーク |
| 攻撃条件の複雑さ | 低 |
| 必要な特権レベル | 不要 |
| ユーザ関与レベル | 不要 |
| スコープ | 変更なし |
| 機密性への影響 | なし |
| 完全性への影響 | なし |
| 可用性への影響 | 高 |

## [CVE-2022-30632] path/filepath: stack exhaustion in Glob

{{< fig-quote type="markdown" title="Go 1.18.4 and Go 1.17.12 are released" link="https://groups.google.com/g/golang-announce/c/nqrv9fbR0zE" lang="en" >}}
{{% quote %}}Calling `Glob` on a path which contains a large number of path separators can cause a panic due to stack exhaustion{{% /quote %}}.
{{< /fig-quote >}}

- `CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H`
- 深刻度: 重要 (Score: 7.5)

| 基本評価基準 | 評価値 |
|--------|-------|
| 攻撃元区分 | ネットワーク |
| 攻撃条件の複雑さ | 低 |
| 必要な特権レベル | 不要 |
| ユーザ関与レベル | 不要 |
| スコープ | 変更なし |
| 機密性への影響 | なし |
| 完全性への影響 | なし |
| 可用性への影響 | 高 |

## [CVE-2022-30630] io/fs: stack exhaustion in Glob

{{< fig-quote type="markdown" title="Go 1.18.4 and Go 1.17.12 are released" link="https://groups.google.com/g/golang-announce/c/nqrv9fbR0zE" lang="en" >}}
{{% quote %}}Calling `Glob` on a path which contains a large number of path separators can cause a panic due to stack exhaustion{{% /quote %}}.
{{< /fig-quote >}}

- `CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H`
- 深刻度: 重要 (Score: 7.5)

| 基本評価基準 | 評価値 |
|--------|-------|
| 攻撃元区分 | ネットワーク |
| 攻撃条件の複雑さ | 低 |
| 必要な特権レベル | 不要 |
| ユーザ関与レベル | 不要 |
| スコープ | 変更なし |
| 機密性への影響 | なし |
| 完全性への影響 | なし |
| 可用性への影響 | 高 |

## [CVE-2022-1962] go/parser: stack exhaustion in all Parse* functions

{{< fig-quote type="markdown" title="Go 1.18.4 and Go 1.17.12 are released" link="https://groups.google.com/g/golang-announce/c/nqrv9fbR0zE" lang="en" >}}
{{% quote %}}Calling any of the `Parse` functions on Go source code which contains deeply nested types or declarations can cause a panic due to stack exhaustion{{% /quote %}}.
{{< /fig-quote >}}

- `CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H`
- 深刻度: 警告 (Score: 5.5)

| 基本評価基準 | 評価値 |
|--------|-------|
| 攻撃元区分 | ローカル |
| 攻撃条件の複雑さ | 低 |
| 必要な特権レベル | 低 |
| ユーザ関与レベル | 不要 |
| スコープ | 変更なし |
| 機密性への影響 | なし |
| 完全性への影響 | なし |
| 可用性への影響 | 高 |

## 例によって...

[Ubuntu] の APT で管理している [Go] コンパイラは古いので，[ダウンロードページ](https://go.dev/dl/ "Downloads - go.dev")からバイナリ（[`go1.18.4.linux-amd64.tar.gz`](https://go.dev/dl/go1.18.4.linux-amd64.tar.gz)）を取ってきてインストールすることを強く推奨する。
以下は完全手動での作業例。

```text
$ cd /usr/local/src
$ sudo curl -L "https://go.dev/dl/go1.18.4.linux-amd64.tar.gz" -O
$ cd ..
$ sudo unlink go # 以前の Go が入っている場合
$ sudo tar xvf src/go1.18.4.linux-amd64.tar.gz
$ sudo mv go go1.18.4
$ sudo ln -s go1.18.4 go
$ go version # /usr/local/go/bin にパスが通っている場合
go version go1.18.4 linux/amd64
```

Windows は [Scoop] 経由で OK

アップデートは計画的に。

[Go]: https://go.dev/
[Ubuntu]: https://www.ubuntu.com/ "The leading operating system for PCs, IoT devices, servers and the cloud | Ubuntu"
[Scoop]: https://scoop.sh/
[CVE-2022-29526]: https://nvd.nist.gov/vuln/detail/CVE-2022-29526
[CVE-2022-30634]: https://nvd.nist.gov/vuln/detail/CVE-2022-30634
[CVE-2022-30629]: https://nvd.nist.gov/vuln/detail/CVE-2022-30629
[CVE-2022-30580]: https://nvd.nist.gov/vuln/detail/CVE-2022-30580
[CVE-2022-29804]: https://nvd.nist.gov/vuln/detail/CVE-2022-29804
[CVE-2022-1705]: https://nvd.nist.gov/vuln/detail/CVE-2022-1705
[CVE-2022-32148]: https://nvd.nist.gov/vuln/detail/CVE-2022-32148
[CVE-2022-30631]: https://nvd.nist.gov/vuln/detail/CVE-2022-30631
[CVE-2022-30633]: https://nvd.nist.gov/vuln/detail/CVE-2022-30633
[CVE-2022-28131]: https://nvd.nist.gov/vuln/detail/CVE-2022-28131
[CVE-2022-30635]: https://nvd.nist.gov/vuln/detail/CVE-2022-30635
[CVE-2022-30632]: https://nvd.nist.gov/vuln/detail/CVE-2022-30632
[CVE-2022-30630]: https://nvd.nist.gov/vuln/detail/CVE-2022-30630
[CVE-2022-1962]: https://nvd.nist.gov/vuln/detail/CVE-2022-1962

## 参考図書

{{% review-paapi "B099928SJD" %}} <!-- プログラミング言語Go -->
