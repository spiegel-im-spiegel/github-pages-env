# Microsoft 製の複数の Windows アプリケーションおよびインストーラにおける DLL 読み込みに関する脆弱性

[JVNDB-2018-000049](https://jvndb.jvn.jp/ja/contents/2018/JVNDB-2018-000049.html "Microsoft 製の複数の Windows アプリケーションおよびインストーラにおける DLL 読み込みに関する脆弱性") が発行されたので以下に書き出しておく。

% fig-quote title="Microsoft 製の複数の Windows アプリケーションおよびインストーラにおける DLL 読み込みに関する脆弱性" link="https://jvndb.jvn.jp/ja/contents/2018/JVNDB-2018-000049.html" %
## 脆弱性の概要

Microsoft が提供する複数の Windows アプリケーションおよびインストーラには、DLL を読み込む際の検索パスに関する処理に不備があり、該当するアプリケーションやインストーラと同一のディレクトリ内に存在する特定の DLL ファイルを読み込んでしまう脆弱性 (CWE-427) が存在します。 開発者によると、本件は「アプリケーション ディレクトリにおける DLL の植え付け」の問題であり、実際の攻撃実現性は限定的であるため、セキュリティ更新プログラムによる対応は行なわないとのことです。  開発者による「アプリケーション ディレクトリにおける DLL の植え付け」への対応については、開発者が提供する情報をご確認ください。  この脆弱性情報は、情報セキュリティ早期警戒パートナーシップに基づき下記の方が IPA に報告し、JPCERT/CC が開発者との調整を行いました。 CVE-2018-0592、CVE-2018-0593、CVE-2018-0596 報告者: 三井物産セキュアディレクション株式会社 吉川孝志 氏 CVE-2018-0594 報告者: PinkFlyingWhale 黒翼猫 氏 CVE-2018-0595、CVE-2018-0597 報告者: 英利 雅美 氏

## 想定される影響

本脆弱性の影響を受けるアプリケーションやインストーラを実行する際に、細工された DLL ファイルが同一ディレクトリに置かれていた場合、当該アプリケーションやインストーラの権限で任意のコードを実行される可能性があります。

### 影響を受ける製品

- マイクロソフト / Microsoft OneDrive - CVE-2018-0592
- マイクロソフト / Microsoft OneDrive のインストーラ - CVE-2018-0593
- マイクロソフト / Skype for Windows - CVE-2018-0594
- マイクロソフト / Skype for Windows のインストーラ - CVE-2018-0595
- マイクロソフト / Visual Studio Code のインストーラ - CVE-2018-0597
- マイクロソフト / Visual Studio Community のインストーラ - CVE-2018-0596


### 深刻度

重要 (7.8) : CVSS:3.0/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H

| 基本評価基準 | 評価値 |
|--------|-------|
| 攻撃元区分 | ローカル |
| 攻撃条件の複雑さ | 低 |
| 必要な特権レベル | 不要 |
| ユーザ関与レベル | 要 |
| スコープ | 変更なし |
| 機密性への影響 | 高 |
| 完全性への影響 | 高 |
| 可用性への影響 | 高 |


## 対策

[ワークアラウンドを実施する] 次のワークアラウンドを実施することで、本脆弱性の影響を軽減することが可能です。 ・システムディレクトリへの書き込みは管理者にのみ許可する (Windows の初期設定) ・Windows PC は管理者権限を持たない標準ユーザアカウントで操作することを原則とし、必要なときのみ管理者アカウントで操作する ・インストーラは新たに作成したディレクトリに保存し、他の無関係なファイルが存在しない状態で実行する ・アプリケーションをインストールしたディレクトリに信用できないファイルが存在しないことを確認する ・社内でインストーラを共有ディレクトリに置き、各 Windows PC にインストールさせるような運用を行っている場合は、当該ディレクトリを読み取り専用にする Microsoft OneDrive など、アプリケーションによってはユーザディレクトリ配下にインストールされる場合があります。各アプリケーションにあわせて適切なワークアラウンドを実施してください。

## 関連情報

- Common Vulnerabilities and Exposures (CVE) [CVE-2018-0592](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-0592) 
- Common Vulnerabilities and Exposures (CVE) [CVE-2018-0593](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-0593) 
- Common Vulnerabilities and Exposures (CVE) [CVE-2018-0594](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-0594) 
- Common Vulnerabilities and Exposures (CVE) [CVE-2018-0595](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-0595) 
- Common Vulnerabilities and Exposures (CVE) [CVE-2018-0596](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-0596) 
- Common Vulnerabilities and Exposures (CVE) [CVE-2018-0597](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-0597) 
- JVN [JVN#91151862](https://jvn.jp/jp/JVN91151862/index.html) 
- JVN [JVNTA#91240916](https://jvn.jp/ta/JVNTA91240916/index.html) 
- JVNDB [CWE-Other](https://www.ipa.go.jp/security/vuln/CWE.html#CWEOther) その他
- Microsoft TechNet [DLL の植え付けの脆弱性のトリアージ](https://blogs.technet.microsoft.com/jpsecurity/2018/04/10/triaging-a-dll-planting-vulnerability/) 


(Powerd by [JVN](https://jvn.jp/) & [jvnman](https://github.com/spiegel-im-spiegel/jvnman "spiegel-im-spiegel/jvnman: JVN Vulnerability Data Management"))
% /fig-quote %
