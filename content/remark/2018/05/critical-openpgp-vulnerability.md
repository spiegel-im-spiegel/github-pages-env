+++
title = "OpenPGP および S/MIME メールクライアントの脆弱性について"
date = "2018-05-15T21:15:42+09:00"
description = "昨日くらいから GnuPG のメーリングリストが騒がしかったが，これのせいか。"
image = "/images/attention/kitten.jpg"
tags = [
  "security",
  "vulnerability",
  "cryptography",
  "openpgp",
  "mua",
]

[author]
  name      = "Spiegel"
  url       = "http://www.baldanders.info/spiegel/profile/"
  avatar    = "/images/avatar.jpg"
  license   = "by-sa"
  github    = "spiegel-im-spiegel"
  twitter   = "spiegel_2007"
  tumblr    = "spiegel-im-spiegel"
  instagram = "spiegel_2007"
  flickr    = "spiegel"
  facebook  = "spiegel.im.spiegel"
  linkedin  = "spiegelimspiegel"
  flattr    = "spiegel"

[scripts]
  mathjax = false
  mermaidjs = false
+++

昨日くらいから [GnuPG のメーリングリスト](https://lists.gnupg.org/pipermail/gnupg-users/2018-May/060315.html "Efail or OpenPGP is safer than S/MIME")が騒がしかったが，これのせいか。

- [EFAIL describes vulnerabilities in the end-to-end encryption technologies OpenPGP and S/MIME that leak the plaintext of encrypted emails.](https://efail.de/)
- {{< pdf-file title="Efail: Breaking S/MIME and OpenPGP Email Encryption using Exfiltration Channels" link="https://efail.de/efail-attack-paper.pdf" >}}

一応日本語のアナウンスも出ている。

- [メールクライアントにおける OpenPGP および S/MIME のメッセージの取り扱いに関する注意喚起](https://www.jpcert.or.jp/at/2018/at180023.html)
- [JVNVU#95575473: OpenPGP および S/MIME メールクライアントにメッセージの取り扱いに関する脆弱性](https://jvn.jp/vu/JVNVU95575473/)

{{< fig-quote title="OpenPGP および S/MIME メールクライアントにメッセージの取り扱いに関する脆弱性" link="https://jvn.jp/vu/JVNVU95575473/" >}}
<q>OpenPGP および S/MIME をサポートする電子メールクライアントには、攻撃者が細工したコンテンツを挿入した暗号化メールをユーザのメールクライアントで復号させることにより、平文を送信するためのチャネルを確立することが可能です。発見者はこの脆弱性を用いた攻撃を "CBC/CFB gadget attack" と呼んでいます。例えば HTML image タグを挿入させることにより、復号されたメッセージが HTTP リクエストの一部として送信されてしまう可能性があります。<br>
また、一部のメールクライアントでは、マルチパートの MIME メッセージを正しく分離して処理しないため、攻撃者は暗号化されたメールを平文の MIME パートに含めることが可能になります。この場合、CBC/CFB gadget attack を実行することなく平文メッセージが送信されてしまう可能性があります。</q>
{{< /fig-quote  >}}

今のところの回避・軽減方法は以下の通り。

{{% fig-quote title="OpenPGP および S/MIME メールクライアントにメッセージの取り扱いに関する脆弱性" link="https://jvn.jp/vu/JVNVU95575473/" %}}
- メールクライアントとは別のアプリケーションを使って復号する
- メールクライアントの HTML レンダリングを無効化する
- メールクライアントのリモートコンテンツの読み込みを無効化する
{{% /fig-quote  %}}

詳しいことが分かり次第，この記事に追記することにする。

つか，暗号化メッセージングに暗号化電子メールはもはや適切とは言えないので，この機会に電子メール以外の手段も考えておくべきだろう。

## ブックマーク

- [Vulnerability Note VU#122919 - OpenPGP and S/MIME mail client vulnerabilities](https://www.kb.cert.org/vuls/id/122919) : 影響を受ける製品の一覧がある。必見
- [Attention PGP Users: New Vulnerabilities Require You To Take Action Now | Electronic Frontier Foundation](https://www.eff.org/deeplinks/2018/05/attention-pgp-users-new-vulnerabilities-require-you-take-action-now)
- [Critical PGP Vulnerability - Schneier on Security](https://www.schneier.com/blog/archives/2018/05/critical_pgp_vu.html)
- [暗号化メールの内容が平文で漏洩する“EFAIL”脆弱性、欧州の研究者グループが発表 - 窓の杜](https://forest.watch.impress.co.jp/docs/news/1121880.html)
- [【対策あり】iPhoneやMacのメールアプリに「eFail」と呼ばれる脆弱性 - iPhone Mania](https://iphone-mania.jp/news-212434/)
- [MIT Tech Review: メールで使われる暗号化技術に脆弱性、内容読まれる恐れ](https://www.technologyreview.jp/nl/an-e-fail-in-e-mail-could-let-hackers-read-your-encrypted-messages/)
- [暗号化メールを平文で読まれる恐れ、「PGP」「S/MIME」に脆弱性 (1/2) - ITmedia エンタープライズ](http://www.itmedia.co.jp/enterprise/articles/1805/15/news062.html)
