+++
date = "2016-02-28T11:06:13+09:00"
description = "いや，まぁ，大騒ぎするほどのことではないけど，一応ね。"
draft = false
tags = ["security", "vulnerability", "wireless", "device"]
title = "無線キーボード/マウス機器の脆弱性"

[author]
  avatar = "/images/avatar.jpg"
  facebook = "spiegel.im.spiegel"
  flattr = "spiegel"
  flickr = "spiegel"
  github = "spiegel-im-spiegel"
  instagram = "spiegel_2007"
  license = "by-sa"
  linkedin = "spiegelimspiegel"
  name = "Spiegel"
  tumblr = "spiegel-im-spiegel"
  twitter = "spiegel_2007"
  url = "http://www.baldanders.info/spiegel/profile/"
+++

いや，まぁ，大騒ぎするほどのことではないけど，一応ね。

## 脆弱性の内容

無線接続のキーボードやマウスなどの機器のうち，安全でない独自通信プロトコルのものがある。

{{< fig-quote title="JVNVU#99797968: 無線接続するキーボードやマウスなどの入力機器が安全でない独自通信プロトコルを使用している問題" link="http://jvn.jp/vu/JVNVU99797968/" >}}
<q>複数の無線接続の入力機器 (キーボードやマウスなど) は、2.4GHz 帯 (ISM バンド) を使用する独自の無線通信プロトコルを実装しており、このプロトコルにおける通信の暗号化に不備が存在します。無線通信の到達範囲にいる攻撃者は、ユーザの端末にキー入力を送りつけたり、キーボードに打ち込まれた内容を傍受したり、ユーザの端末を別の入力機器とペアリングさせたりすることが可能です。無線通信の有効範囲は機器によって異なりますが、室内で使用する多くの場合には数メートル程度です。</q>
{{< /fig-quote >}}

自宅や職場でのインパクトは小さいと思う。
自称「遊牧民」な方々は要注意か。
Bluetooth で接続されている機器は今回は対象外らしいので，そっちに買い換えるのもあり。

## 影響度（CVSS）

**CVSSv2 基本評価値 2.9 (AV:A/AC:M/Au:N/C:N/I:P/A:N)**

“[Vulnerability Note VU#981271 - Multiple wireless keyboard/mouse devices use an unsafe proprietary wireless protocol](https://www.kb.cert.org/vuls/id/981271)” より

| 基本評価基準                            | 評価値            |
|----------------------------------------:|:------------------|
| 攻撃元区分（AV）                        | 隣接ネットワーク（A） |
| 攻撃条件の複雑さ（AC）                  | 中（M）           |
| 攻撃前の認証要否（Au）                  | 不要（N）         |
| 情報漏えいの可能性（機密性への影響, C） | なし（N）         |
| 情報改ざんの可能性（完全性への影響, I） | 部分的（P）       |
| 業務停止の可能性（可用性への影響, A）   | なし（N）         |

**CVSSv3 基本評価値 6.3 (CVSS:3.0/AV:A/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L)**

「[JVNVU#99797968: 無線接続するキーボードやマウスなどの入力機器が安全でない独自通信プロトコルを使用している問題](http://jvn.jp/vu/JVNVU99797968/)」より

| 基本評価基準                            | 評価値            |
|----------------------------------------:|:------------------|
| 攻撃元区分（AV）                        | 隣接（A）         |
| 攻撃条件の複雑さ（AC）                  | 低（L）           |
| 必要な特権レベル（PR）                  | 不要（N）         |
| ユーザ関与レベル（UI）                  | 不要（N）         |
| スコープ（S）                           | 変更なし（U）     |
| 情報漏えいの可能性（機密性への影響, C） | 低（L）           |
| 情報改ざんの可能性（完全性への影響, I） | 低（L）           |
| 業務停止の可能性（可用性への影響, A）   | 低（L）           |

CVSS については[解説ページ]({{< relref "remark/2015/cvss-v3-metrics-in-jvn.md" >}})を参照のこと。

## 影響を受ける製品

- Logitech （ロジクール）
    - [Logitech Response to Unifying Receiver Research Fi... - Logitech Forums](http://forums.logitech.com/t5/Mice-and-Pointing-Devices/Logitech-Response-to-Unifying-Receiver-Research-Findings/td-p/1493878)

以下のベンダ製品については[脆弱性が報告](https://github.com/RFStorm/mousejack/tree/master/doc/advisories)されているものの，ベンダからは詳細情報なし。

- Amazon
- Dell
- Gigabyte
- HP
- Lenovo
- Microsoft

## 対策・回避策

各ベンダから提供されるファームウェアのアップデートが必要。
最初に書いたように自宅や職場ではインパクトが小さいので，機会を見てセキュリティのしっかりした製品に買い換える手もあり。
買い換えは慌てず騒がず計画的に。

## 参考

- [MouseJack Affected Devices | Bastille Networks Internet Security](https://www.bastille.net/affected-devices)
    - [RFStorm/mousejack: Firmware and research tools for Nordic Semiconductor nRF24LU1+ based USB dongles and breakout boards.](https://github.com/rfstorm/mousejack)
- [MOUSEJACK - Wireless Mouse Hacks & Network Security Protection | Mousejack](https://www.mousejack.com/)
- [Vulnerability Note VU#981271 - Multiple wireless keyboard/mouse devices use an unsafe proprietary wireless protocol](https://www.kb.cert.org/vuls/id/981271)
- [JVNVU#99797968: 無線接続するキーボードやマウスなどの入力機器が安全でない独自通信プロトコルを使用している問題](http://jvn.jp/vu/JVNVU99797968/)
