+++
title = "OpenPGP および S/MIME メールクライアントの脆弱性について"
date = "2018-05-15T21:15:42+09:00"
update = "2018-05-23T21:07:20+09:00"
description = "昨日くらいから GnuPG のメーリングリストが騒がしかったが，これのせいか。"
image = "/images/attention/kitten.jpg"
tags = [
  "security",
  "vulnerability",
  "cryptography",
  "openpgp",
  "mua",
]

[author]
  name      = "Spiegel"
  url       = "https://baldanders.info/spiegel/profile/"
  avatar    = "/images/avatar.jpg"
  license   = "by-sa"
  github    = "spiegel-im-spiegel"
  twitter   = "spiegel_2007"
  tumblr    = ""
  instagram = "spiegel_2007"
  flickr    = "spiegel"
  facebook  = "spiegel.im.spiegel"
  linkedin  = "spiegelimspiegel"
  flattr    = ""

[scripts]
  mathjax = false
  mermaidjs = false
+++

昨日くらいから [GnuPG のメーリングリスト](https://lists.gnupg.org/pipermail/gnupg-users/2018-May/060315.html "Efail or OpenPGP is safer than S/MIME")が騒がしかったが，これのせいか。

- [EFAIL describes vulnerabilities in the end-to-end encryption technologies OpenPGP and S/MIME that leak the plaintext of encrypted emails.](https://efail.de/)
- {{< pdf-file title="Efail: Breaking S/MIME and OpenPGP Email Encryption using Exfiltration Channels" link="https://efail.de/efail-attack-paper.pdf" >}}

[JVNDB-2017-012995](https://jvndb.jvn.jp/ja/contents/2017/JVNDB-2017-012995.html "OpenPGP および S/MIME メールクライアントにメッセージの取り扱いに関する脆弱性") が発行されたので以下に書き出しておく（早速 [jvnman] を使うことになるとは`w`）。

[jvnman]: https://github.com/spiegel-im-spiegel/jvnman "spiegel-im-spiegel/jvnman: JVN Vulnerability Data Management"

{{% fig-quote title="JVNDB-2017-012995" link="https://jvndb.jvn.jp/ja/contents/2017/JVNDB-2017-012995.html" %}}
## 脆弱性の概要

平文メッセージが漏えいする可能性があります。  OpenPGP および S/MIME をサポートする電子メールクライアントには、攻撃者が細工したコンテンツを挿入した暗号化メールをユーザのメールクライアントで復号させることにより、平文を送信するためのチャネルを確立することが可能です。
発見者はこの脆弱性を用いた攻撃を "CBC/CFB gadget attack" と呼んでいます。例えば HTML image タグを挿入させることにより、復号されたメッセージが HTTP リクエストの一部として送信されてしまう可能性があります。

* CVE-2017-17688: OpenPGP CFB Attacks
* CVE-2017-17689: S/MIME CBC Attacks

また、一部のメールクライアントでは、マルチパートの MIME メッセージを正しく分離して処理しないため、攻撃者は暗号化されたメールを平文の MIME パートに含めることが可能になります。この場合、CBC/CFB gadget attack を実行することなく平文メッセージが送信されてしまう可能性があります。  詳細は、<a href="https://efail.de/efail-attack-paper.pdf" target="blank">発見者が提供する論文</a>を参照して下さい。 

## 想定される影響

遠隔の第三者により、復号に必要な鍵情報なしに暗号化メールから平文を取得される可能性があります。

### 影響を受ける製品

- （複数のベンダ） / （複数の製品） 

### 深刻度

CVSSv3 評価なし

## 対策

[ワークアラウンドを実施する] 次のワークアラウンドを実施することで、本脆弱性の影響を軽減することが可能です。

* メールクライアントとは別のアプリケーションを使って復号する
* メールクライアントの HTML レンダリングを無効化する
* メールクライアントのリモートコンテンツの読み込みを無効化する

## 関連情報

- Common Vulnerabilities and Exposures (CVE) [CVE-2017-17688](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-17688) 
- Common Vulnerabilities and Exposures (CVE) [CVE-2017-17689](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-17689) 
- JVN [JVNVU#95575473](https://jvn.jp/vu/JVNVU95575473/) 
- US-CERT Vulnerability Note [VU#122919](https://www.kb.cert.org/vuls/id/122919) 
- 関連文書 [EFAIL](https://efail.de/) 
- 関連文書 [Efail: Breaking S/MIME and OpenPGP Email Encryption using Exfiltration Channels (draft 0.9.0)](https://efail.de/efail-attack-paper.pdf) 

(Powerd by [JVN](https://jvn.jp/) & [jvnman](https://github.com/spiegel-im-spiegel/jvnman "spiegel-im-spiegel/jvnman: JVN Vulnerability Data Management"))
{{% /fig-quote %}}


影響を受ける製品については以下を参照のこと。

- [Vulnerability Note VU#122919 - OpenPGP and S/MIME mail client vulnerabilities](https://www.kb.cert.org/vuls/id/122919)

つか，暗号化メッセージングに電子メールはもはや適切とは言えないので，この機会に他の手段も併せて考えておくべきだろう。

## その他ブックマーク

- [Attention PGP Users: New Vulnerabilities Require You To Take Action Now | Electronic Frontier Foundation](https://www.eff.org/deeplinks/2018/05/attention-pgp-users-new-vulnerabilities-require-you-take-action-now)
- [Critical PGP Vulnerability - Schneier on Security](https://www.schneier.com/blog/archives/2018/05/critical_pgp_vu.html)
- [EFAIL and KMail | KDE.news](https://dot.kde.org/2018/05/15/efail-and-kmail)

- [メールクライアントにおける OpenPGP および S/MIME のメッセージの取り扱いに関する注意喚起](https://www.jpcert.or.jp/at/2018/at180023.html)
- [暗号化メールの内容が平文で漏洩する“EFAIL”脆弱性、欧州の研究者グループが発表 - 窓の杜](https://forest.watch.impress.co.jp/docs/news/1121880.html)
- [【対策あり】iPhoneやMacのメールアプリに「eFail」と呼ばれる脆弱性 - iPhone Mania](https://iphone-mania.jp/news-212434/)
- [MIT Tech Review: メールで使われる暗号化技術に脆弱性、内容読まれる恐れ](https://www.technologyreview.jp/nl/an-e-fail-in-e-mail-could-let-hackers-read-your-encrypted-messages/)
- [暗号化メールを平文で読まれる恐れ、「PGP」「S/MIME」に脆弱性 (1/2) - ITmedia エンタープライズ](http://www.itmedia.co.jp/enterprise/articles/1805/15/news062.html)
- [Thunderbird、アップデート推奨 - 暗号メールの脆弱性修正 | マイナビニュース](https://news.mynavi.jp/article/20180522-633761/)
    - [Mozilla、Thunderbirdの暗号メールの脆弱性と対策について説明 | マイナビニュース](https://news.mynavi.jp/article/20180518-632038/)
- [サイトー企画、“EFAIL”脆弱性への対策を行った「秀丸メール」v6.82を正式公開 - 窓の杜](https://forest.watch.impress.co.jp/docs/news/1123137.html)
