# Visual C++ 再頒布可能パッケージのインストーラにおける DLL 読み込みの脆弱性

[JVNDB-2018-000051](https://jvndb.jvn.jp/ja/contents/2018/JVNDB-2018-000051.html "Visual C++ 再頒布可能パッケージのインストーラにおける DLL 読み込みの脆弱性") が発行されたので以下に書き出しておく。

{{% fig-quote title=".Info.Title" link="https://jvndb.jvn.jp/ja/contents/2018/JVNDB-2018-000051.html" %}}
## 脆弱性の概要

Microsoft が提供する Visual C++ 再頒布可能パッケージのインストーラには、DLL を読み込む際の検索パスに関する処理に不備があり、インストーラと同一のディレクトリ内に存在する特定の DLL ファイルを読み込んでしまう脆弱性 (CWE-427) が存在します。 開発者によると、本件は「アプリケーション ディレクトリにおける DLL の植え付け」の問題であり、実際の攻撃実現性は限定的であるため、セキュリティ更新プログラムによる対応は行わないとのことです。  開発者による「アプリケーション ディレクトリにおける DLL の植え付け」への対応については、開発者が提供する情報をご確認ください。

## 想定される影響

インストーラを実行している権限で、任意のコードを実行される可能性があります。

### 影響を受ける製品

- マイクロソフト / Visual C++ 再頒布可能パッケージ 


### 深刻度

重要 (7.8) : CVSS:3.0/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H

| 基本評価基準 | 評価値 |
|--------|-------|
| 攻撃元区分 | ローカル |
| 攻撃条件の複雑さ | 低 |
| 必要な特権レベル | 不要 |
| ユーザ関与レベル | 要 |
| スコープ | 変更なし |
| 機密性への影響 | 高 |
| 完全性への影響 | 高 |
| 可用性への影響 | 高 |


## 対策

[ワークアラウンドを実施する] 次のワークアラウンドを実施することで、本脆弱性の影響を軽減することが可能です。 ・インストーラは新たに作成したディレクトリに保存し、他の無関係なファイルが存在しない状態で実行する ・インストーラを保存したディレクトリに信用できないファイルが存在しないことを確認する

## 関連情報

- Common Vulnerabilities and Exposures (CVE) [CVE-2018-0599](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-0599) 
- JVN [JVN#81196185](https://jvn.jp/jp/JVN81196185/index.html) 
- JVN [JVNTA#91240916](https://jvn.jp/ta/JVNTA91240916/index.html) 
- JVNDB [CWE-Other](https://www.ipa.go.jp/security/vuln/CWE.html#CWEOther) その他
- Microsoft TechNet [DLL の植え付けの脆弱性のトリアージ](https://blogs.technet.microsoft.com/jpsecurity/2018/04/10/triaging-a-dll-planting-vulnerability/) 


(Powerd by [JVN](https://jvn.jp/) & [jvnman](https://github.com/spiegel-im-spiegel/jvnman "spiegel-im-spiegel/jvnman: JVN Vulnerability Data Management"))
{{% /fig-quote %}}
