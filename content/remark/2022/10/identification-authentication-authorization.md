+++
title = "「識別、認証、許可」"
date =  "2022-10-15T11:43:48+09:00"
description = "セキュリティ・システムを組む場合の肝は識別，認証，許可の3つをきちんと分離し上手く組み合わせることである。"
image = "/images/attention/kitten.jpg"
tags = [ "security", "risk", "management", "my-number", "design", "engineering" ]
pageType = "text"

[scripts]
  mathjax = false
  mermaidjs = false
+++

セキュリティ・システムを組む場合の肝は識別（identification），認証（authentication），許可（authorization）の3つを（設計概念上）きちんと分離し，かつそれらを上手く組み合わせることである。

この辺の話は Bruce Schneier さんの名著『[セキュリティはなぜやぶられたのか](https://www.amazon.co.jp/dp/4822283100?tag=baldandersinf-22&linkCode=ogi&th=1&psc=1)（原著名 “[Beyond Fear](https://www.amazon.co.jp/dp/B000PY3NB4?tag=baldandersinf-22&linkCode=ogi&th=1&psc=1)”）』の13章で詳しく解説されている。

{{% review-paapi "4822283100" %}} <!-- セキュリティはなぜやぶられたのか -->

これによると 識別・認証・許可 の各機能は以下の通り。

{{< fig-quote type="markdown" title="『セキュリティはなぜやぶられたのか』 p269" link="https://www.amazon.co.jp/dp/4822283100?tag=baldandersinf-22&linkCode=ogi&th=1&psc=1" >}}
- **識別**： あなたは誰？
- **認証**： 証明しろ
- **許可**： この範囲のことはしてもよい
{{< /fig-quote >}}

さらに言うと，コンピュータ・システムでは 識別・認証・許可 はそれぞれ「トークン」として符号化されることが多く，そのトークンを認証（certification）する機能も要求される。

たとえば映画館の入場券は純粋に許可トークンである。
このトークンがあれば誰が入場しようと問題ない。
たとえそれが他者から奪い取ったものだとしても。

ライブチケットも同様に許可トークンだが，近年では転売屋対策で，「誰」が購入したものか特定するために識別トークンを兼ねていることが多い。
この場合，入場時にチケットを持っているのが本人かどうか証明する必要があるため何らかの認証トークンと紐付けることになる。

これで 識別・認証・許可 について何となくイメージできただろうか。
では本題へ。

昨今，「{{% ruby "マイナンバー" %}}個人番号{{% /ruby %}}」が某日本政府の無茶振りによりまたぞろ話題になっているが，個人番号自体はただの識別トークンであり，それ単体では何も認証しないし何も許可されない。
個人番号はお役所などの窓口で提示することで（主にお役所側の都合で）各種業務フローを簡素化できると期待されている。
つまり個人番号と本人がセットになることではじめて認証も許可も機能し始めるのだ[^id1]。

[^id1]: 個人番号は秘密情報ではないが重要な個人情報のひとつではある。個人番号がもたらすプライバシー上のリスクは当然あるが，この記事で書くとカオスになるので言及しない。

私も[引っ越し]({{< ref "/remark/2022/02/moving-2022.md" >}} "引っ越し 2022")をした時に個人番号カードを提示するだけで各種届け出を全部やってもらったので有り難かった記憶がある。
もっとも引っ越すたびに個人番号カードを書き換えないといけないので，利用者にとってホンマに便利か微妙なところであるが（笑）

その個人番号カードであるが，これには「利用者証明用電子証明書」が組み込まれている。
また希望者には住基ネットの「署名用電子証明書」を組み込むこともできる。
署名用電子証明書は，確定申告をネットで行う人にはおなじみのやつだ。
つまり「個人番号カード」のほうは認証トークンを兼ねているのである。
これは非常に重要な機能である。

署名用電子証明書はある程度長いパスワードで秘匿できるが[^j1]，利用者証明用電子証明書のほうは4桁の暗証番号のみでロックされている。
さらに言うと昨今では個人番号カードの[3つの暗証番号を同一にするよう勧められる]({{< ref "/remark/2020/05/my-number-card.md" >}} "引っ越ししたら個人番号カードを更新しましょう")らしい。

[^j1]: 住基関連の機能を使う場合は専用の暗証番号でアンロックし，その上で署名のためのパスワードを入力する必要がある。つまり二重にロックされているわけだ。

認証トークンとしての個人番号カードが（住基周りを除いて）こんなに緩いのは「個人番号」自体が所詮はお役所サービスのためのシステムに過ぎないからだと認識しているのだが，どうだろう。

でも，ここで個人番号カードに健康保険証や運転免許証を統合し，これによって個人番号カード所持を事実上強制しようという動きがある。
健康保険や運転免許のシステムを個人番号の下に統合しようというのなら分かる（実装の仕方にもよるが）。
しかし個人番号カードは単なる情報（数字列）ではなく物理媒体であり，かつ行政サービス向けの重要な（割に運用の緩い）認証トークンである点が問題である。

私は個人番号カードは普段持ち歩かないようにしている（当然だよね）。
一方で持病持ちの私は健康保険証は肌身離さず持ち歩かざるを得ない。
運転免許証についても身分証明証代わりに持ち歩いている人もいればクルマのダッシュボードに入れっぱなしの人もいるだろう。
また紛失・盗難が起きた際のインパクトも「事後」の取り扱いも利用者およびサービスによって全く異なる。

たとえば個人番号カードに健康保険証を組み込んだ場合，個人番号カード紛失時の再取得に手間と時間がかかるし（平日に有給休暇を取ってお役所詣で），その上で健康保険証機能も再発行してもらわないといけない。
私のような持病持ちには無視できないインパクトだ。
年に1回利用するかしないか程度のお役所サービスを受けるために日常的に使っているサービスが巻き添えになるのである。

まとめよう。

カード媒体は紛失・盗難リスクが高い。
付随するサービスによって扱いは異なるし，可能であれば「所持しない」のが最善と言える。
それを「お買い物ポイント」で釣って運用リスクやコストの高いものを所持させるとかどこの詐欺師かって感じだし，ましてや利用ドメインの異なるサービスを抱き合わせにしようとか鬼畜としか言いようがない。

できれば勘弁して欲しいところであるが，どうなるやら。

## ブックマーク

- [固有IDのシンプル・シナリオ](https://www.hyuki.com/techinfo/uniqid.html)

- [「特別定額給付金」申請のナニがダメだったのか]({{< ref "/remark/2020/05/bottleneck.md" >}})
- [「特別定額給付金」申請のナニがダメだったのか（その2）]({{< ref "/remark/2020/06/bottleneck2.md" >}})
- [個人番号と個人番号カード]({{< ref "/remark/2020/09/my-number-and-my-number-card.md" >}})
